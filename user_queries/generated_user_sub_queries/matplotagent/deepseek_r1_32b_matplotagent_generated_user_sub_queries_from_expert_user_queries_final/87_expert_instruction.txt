"""
        You are an assistant designed to break down a complex data science or geospatial analysis task 
        into smaller, focused sub-queries. Each sub-query must target a specific technical domain 
        so that relevant documentation, examples, or code can be retrieved using a vector database.

        Given the user query, return 3 clearly separated sub-queries:

        1. HDF5 Dataset Access:
        Focus only on `h5py` such as accessing file with extensions H5, h5, HE5, he5, HDF5, or hdf5, 
        accessing datasets or attributes, dataset paths (like `/Grid/cloudWater`), and metadata.

        2. NumPy-based Data Preprocessing:
        Focus only on how to handle `_FillValue`, apply masks using NumPy (`np.where`, `np.ma.masked_where`), and compute or filter data using `min`, `max`, or 
        other preprocessing logic.

        3. Map Plotting and Visualization:
        Focus only on how to use `matplotlib`, `mpl_toolkits.basemap`, or `cartopy` to visualize geospatial data, configure projections, draw coastlines, 
        meridians, parallels, and apply colorbars or titles.

        
        User Query:
            Use 87_h5_data.h5 to plot a sunburst chart.
- The hierarchy is defined by the 'continent' and 'country' datasets.
- The size of each segment is determined by the 'pop' dataset (population).
- The color of each segment is determined by the 'lifeExp' datasets (life expectancy).
- The color scale is a diverging scale that goes from red to blue ('RdBu').
- The midpoint of the color scale is the weighted average of the 'lifeExp' values, with the weights being the 'pop' values.
- Add A color bar as a legend for the 'lifeExp' dataset.

        ---
        Note: return only the the response of sub-queries only based on the below format, not explanation, not python code, and node additional text needed
        Return format:

        HDF5 Dataset Access Sub-query:
        <generated sub-query>

        NumPy Data Preprocessing Sub-query:
        <generated sub-query>

        Plotting and Visualization Sub-query:
        <generated sub-query>
        """

<think>
Alright, I need to break down the user's query into three specific sub-queries as per the guidelines. Let me go through each part step by step.

First, the HDF5 Dataset Access sub-query. The user is working with an HDF5 file named 87_h5_data.h5 and needs to access several datasets: 'continent', 'country', 'pop', and 'lifeExp'. They also mentioned using dataset paths like '/Grid/cloudWater' in their example, so I should include how to access these specific datasets by their names. Additionally, metadata might be relevant for understanding the structure, but since the user didn't specify, I'll focus on accessing the required datasets.

Next, the NumPy-based Data Preprocessing sub-query. The user wants to compute a weighted average of 'lifeExp' using 'pop' as weights. This involves handling any potential fill values in the data, which might be NaNs or specific markers. They also need to apply masks where population is zero or negative because those shouldn't contribute to the visualization. So, I'll structure this sub-query around calculating the weighted average and filtering out invalid data points.

Lastly, the Map Plotting and Visualization sub-query. The user wants a sunburst chart with continents and countries as hierarchy levels. The size of each segment is based on population, and color represents life expectancy using a diverging 'RdBu' scale. They also need a color bar legend for lifeExp. Since this isn't a traditional map but a hierarchical chart, I'll focus on how to create such a visualization with the specified parameters.

Putting it all together, each sub-query addresses a distinct part of the task: accessing data from HDF5, preprocessing with NumPy, and visualizing with matplotlib or similar libraries.
</think>

HDF5 Dataset Access Sub-query:
How to access the 'continent', 'country', 'pop', and 'lifeExp' datasets from an HDF5 file named 87_h5_data.h5 using h5py?

NumPy Data Preprocessing Sub-query:
How to compute a weighted average of 'lifeExp' values using 'pop' as weights, handle _FillValue, and apply masks where pop <=0 using NumPy?

Plotting and Visualization Sub-query:
How to create a sunburst chart with hierarchy from continent and country, size based on population, color based on life expectancy using RdBu scale, add colorbar legend for lifeExp using matplotlib?