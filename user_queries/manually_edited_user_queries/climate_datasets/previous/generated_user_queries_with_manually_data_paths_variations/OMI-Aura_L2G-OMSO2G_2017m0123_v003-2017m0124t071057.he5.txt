"I'm working with an HDF-EOS5 file and I need to extract specific datasets. Here's what I've done so far:

First, I set up variables for the file name (`OMI-Aura_L2G-OMSO2G_2017m0123_v003-2017m0124t071057.he5`) and paths within the file (`/HDFEOS/GRIDS/OMI Total Column Amount SO2/Data Fields/`). I also specified dataset names: `ColumnAmountSO2_PBL` for data, `Latitude`, and `Longitude`.

Next, I read the datasets using the HDF-EOS5 file's hierarchy. I retrieved attributes like title, units, valid range, fill value, offset, and scale factor.

To handle missing values and valid ranges, I replaced fill values with NaN, applied the scale factor and offset to the data, and masked values outside the valid range.

I then subsetted the data by selecting the first slice of the arrays. Using a cylindrical projection map, I created a scatter plot of the data with coastlines, parallels, and meridians drawn at specific intervals.

Finally, I added a colorbar with units and a title including the file name and dataset title, and saved the plot as a PNG file.